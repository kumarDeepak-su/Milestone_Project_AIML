{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "30a7a87a-d1fd-4215-884d-bdadfc6c6779",
   "metadata": {},
   "source": [
    "**RS Project- Deepak Kumar**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "96f46b4e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9ff33a0d",
   "metadata": {},
   "source": [
    "### 1.Import the necessary libraries and read the provided CSVs as a data frame and perform the below steps. \n",
    "\n",
    "### A.Merge all the provided CSVs into one dataFrame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "6dde05c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "os.chdir('/Users/deepakkumar/Desktop/Data_Set')\n",
    "file1_df = pd.read_csv('phone_user_review_file_1.csv', encoding='ISO-8859-1')\n",
    "file2_df = pd.read_csv('phone_user_review_file_2.csv', encoding='ISO-8859-1')\n",
    "file3_df = pd.read_csv('phone_user_review_file_3.csv', encoding='ISO-8859-1')\n",
    "file4_df = pd.read_csv('phone_user_review_file_4.csv', encoding='ISO-8859-1')\n",
    "file5_df = pd.read_csv('phone_user_review_file_5.csv', encoding='ISO-8859-1')\n",
    "file6_df = pd.read_csv('phone_user_review_file_6.csv', encoding='ISO-8859-1')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "6dfef4ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "combined_review_file = pd.concat([file1_df, file2_df, file3_df, file4_df, file5_df, file6_df]).reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "01295f81",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "0970b914",
   "metadata": {},
   "source": [
    "### B.Explore, understand the Data and share at least 2 observations."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b85c021e",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "59fef9f4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>phone_url</th>\n",
       "      <th>date</th>\n",
       "      <th>lang</th>\n",
       "      <th>country</th>\n",
       "      <th>source</th>\n",
       "      <th>domain</th>\n",
       "      <th>score</th>\n",
       "      <th>score_max</th>\n",
       "      <th>extract</th>\n",
       "      <th>author</th>\n",
       "      <th>product</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>5/2/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Verizon Wireless</td>\n",
       "      <td>verizonwireless.com</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>As a diehard Samsung fan who has had every Sam...</td>\n",
       "      <td>CarolAnn35</td>\n",
       "      <td>Samsung Galaxy S8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>4/28/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Phone Arena</td>\n",
       "      <td>phonearena.com</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Love the phone. the phone is sleek and smooth ...</td>\n",
       "      <td>james0923</td>\n",
       "      <td>Samsung Galaxy S8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>5/4/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Amazon</td>\n",
       "      <td>amazon.com</td>\n",
       "      <td>6.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Adequate feel. Nice heft. Processor's still sl...</td>\n",
       "      <td>R. Craig</td>\n",
       "      <td>Samsung Galaxy S8 (64GB) G950U 5.8\" 4G LTE Unl...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>5/2/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Samsung</td>\n",
       "      <td>samsung.com</td>\n",
       "      <td>9.2</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Never disappointed. One of the reasons I've be...</td>\n",
       "      <td>Buster2020</td>\n",
       "      <td>Samsung Galaxy S8 64GB (AT&amp;T)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>5/11/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Verizon Wireless</td>\n",
       "      <td>verizonwireless.com</td>\n",
       "      <td>4.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>I've now found that i'm in a group of people t...</td>\n",
       "      <td>S Ate Mine</td>\n",
       "      <td>Samsung Galaxy S8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        phone_url       date lang country            source  \\\n",
       "0  /cellphones/samsung-galaxy-s8/   5/2/2017   en      us  Verizon Wireless   \n",
       "1  /cellphones/samsung-galaxy-s8/  4/28/2017   en      us       Phone Arena   \n",
       "2  /cellphones/samsung-galaxy-s8/   5/4/2017   en      us            Amazon   \n",
       "3  /cellphones/samsung-galaxy-s8/   5/2/2017   en      us           Samsung   \n",
       "4  /cellphones/samsung-galaxy-s8/  5/11/2017   en      us  Verizon Wireless   \n",
       "\n",
       "                domain  score  score_max  \\\n",
       "0  verizonwireless.com   10.0       10.0   \n",
       "1       phonearena.com   10.0       10.0   \n",
       "2           amazon.com    6.0       10.0   \n",
       "3          samsung.com    9.2       10.0   \n",
       "4  verizonwireless.com    4.0       10.0   \n",
       "\n",
       "                                             extract       author  \\\n",
       "0  As a diehard Samsung fan who has had every Sam...   CarolAnn35   \n",
       "1  Love the phone. the phone is sleek and smooth ...    james0923   \n",
       "2  Adequate feel. Nice heft. Processor's still sl...     R. Craig   \n",
       "3  Never disappointed. One of the reasons I've be...  Buster2020    \n",
       "4  I've now found that i'm in a group of people t...   S Ate Mine   \n",
       "\n",
       "                                             product  \n",
       "0                                  Samsung Galaxy S8  \n",
       "1                                  Samsung Galaxy S8  \n",
       "2  Samsung Galaxy S8 (64GB) G950U 5.8\" 4G LTE Unl...  \n",
       "3                      Samsung Galaxy S8 64GB (AT&T)  \n",
       "4                                  Samsung Galaxy S8  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "4b7b53b2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1415133, 11)"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "beaef8d1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1415133 entries, 0 to 1415132\n",
      "Data columns (total 11 columns):\n",
      " #   Column     Non-Null Count    Dtype  \n",
      "---  ------     --------------    -----  \n",
      " 0   phone_url  1415133 non-null  object \n",
      " 1   date       1415133 non-null  object \n",
      " 2   lang       1415133 non-null  object \n",
      " 3   country    1415133 non-null  object \n",
      " 4   source     1415133 non-null  object \n",
      " 5   domain     1415133 non-null  object \n",
      " 6   score      1351644 non-null  float64\n",
      " 7   score_max  1351644 non-null  float64\n",
      " 8   extract    1395772 non-null  object \n",
      " 9   author     1351931 non-null  object \n",
      " 10  product    1415132 non-null  object \n",
      "dtypes: float64(2), object(9)\n",
      "memory usage: 118.8+ MB\n"
     ]
    }
   ],
   "source": [
    "combined_review_file.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4914a92b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>score</th>\n",
       "      <th>score_max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>1.351644e+06</td>\n",
       "      <td>1351644.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>8.007060e+00</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>2.616121e+00</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>2.000000e-01</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>7.200000e+00</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>9.200000e+00</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>1.000000e+01</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>1.000000e+01</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              score  score_max\n",
       "count  1.351644e+06  1351644.0\n",
       "mean   8.007060e+00       10.0\n",
       "std    2.616121e+00        0.0\n",
       "min    2.000000e-01       10.0\n",
       "25%    7.200000e+00       10.0\n",
       "50%    9.200000e+00       10.0\n",
       "75%    1.000000e+01       10.0\n",
       "max    1.000000e+01       10.0"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71dd0582",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9b24361f",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "4f133fb6",
   "metadata": {},
   "source": [
    "### C.Round off scores to the nearest integers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "022d9f17",
   "metadata": {},
   "outputs": [],
   "source": [
    "combined_review_file['score'] = combined_review_file['score'].round()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "4f6a39ee",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>score</th>\n",
       "      <th>score_max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>1.351644e+06</td>\n",
       "      <td>1351644.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>8.008083e+00</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>2.617634e+00</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>7.000000e+00</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>9.000000e+00</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>1.000000e+01</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>1.000000e+01</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              score  score_max\n",
       "count  1.351644e+06  1351644.0\n",
       "mean   8.008083e+00       10.0\n",
       "std    2.617634e+00        0.0\n",
       "min    0.000000e+00       10.0\n",
       "25%    7.000000e+00       10.0\n",
       "50%    9.000000e+00       10.0\n",
       "75%    1.000000e+01       10.0\n",
       "max    1.000000e+01       10.0"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7ba4b47e",
   "metadata": {},
   "source": [
    "### D.Check for missing values. Impute the missing values, if any"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "2570229f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "phone_url        0\n",
       "date             0\n",
       "lang             0\n",
       "country          0\n",
       "source           0\n",
       "domain           0\n",
       "score        63489\n",
       "score_max    63489\n",
       "extract      19361\n",
       "author       63202\n",
       "product          1\n",
       "dtype: int64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "6e607f02",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Since most of columns are of Object Data type, we will drop rows containing null values.\n",
    "\n",
    "combined_review_file = combined_review_file.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "9d5b4d97",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>phone_url</th>\n",
       "      <th>date</th>\n",
       "      <th>lang</th>\n",
       "      <th>country</th>\n",
       "      <th>source</th>\n",
       "      <th>domain</th>\n",
       "      <th>score</th>\n",
       "      <th>score_max</th>\n",
       "      <th>extract</th>\n",
       "      <th>author</th>\n",
       "      <th>product</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>5/2/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Verizon Wireless</td>\n",
       "      <td>verizonwireless.com</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>As a diehard Samsung fan who has had every Sam...</td>\n",
       "      <td>CarolAnn35</td>\n",
       "      <td>Samsung Galaxy S8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>4/28/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Phone Arena</td>\n",
       "      <td>phonearena.com</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Love the phone. the phone is sleek and smooth ...</td>\n",
       "      <td>james0923</td>\n",
       "      <td>Samsung Galaxy S8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>5/4/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Amazon</td>\n",
       "      <td>amazon.com</td>\n",
       "      <td>6.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Adequate feel. Nice heft. Processor's still sl...</td>\n",
       "      <td>R. Craig</td>\n",
       "      <td>Samsung Galaxy S8 (64GB) G950U 5.8\" 4G LTE Unl...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>5/2/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Samsung</td>\n",
       "      <td>samsung.com</td>\n",
       "      <td>9.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Never disappointed. One of the reasons I've be...</td>\n",
       "      <td>Buster2020</td>\n",
       "      <td>Samsung Galaxy S8 64GB (AT&amp;T)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>/cellphones/samsung-galaxy-s8/</td>\n",
       "      <td>5/11/2017</td>\n",
       "      <td>en</td>\n",
       "      <td>us</td>\n",
       "      <td>Verizon Wireless</td>\n",
       "      <td>verizonwireless.com</td>\n",
       "      <td>4.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>I've now found that i'm in a group of people t...</td>\n",
       "      <td>S Ate Mine</td>\n",
       "      <td>Samsung Galaxy S8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1415128</th>\n",
       "      <td>/cellphones/alcatel-ot-club_1187/</td>\n",
       "      <td>5/12/2000</td>\n",
       "      <td>de</td>\n",
       "      <td>de</td>\n",
       "      <td>Ciao</td>\n",
       "      <td>ciao.de</td>\n",
       "      <td>2.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Weil mein Onkel bei ALcatel arbeitet habe ich ...</td>\n",
       "      <td>david.paul</td>\n",
       "      <td>Alcatel Club Plus Handy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1415129</th>\n",
       "      <td>/cellphones/alcatel-ot-club_1187/</td>\n",
       "      <td>5/11/2000</td>\n",
       "      <td>de</td>\n",
       "      <td>de</td>\n",
       "      <td>Ciao</td>\n",
       "      <td>ciao.de</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Hy Liebe Leserinnen und Leser!! Ich habe seit ...</td>\n",
       "      <td>Christiane14</td>\n",
       "      <td>Alcatel Club Plus Handy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1415130</th>\n",
       "      <td>/cellphones/alcatel-ot-club_1187/</td>\n",
       "      <td>5/4/2000</td>\n",
       "      <td>de</td>\n",
       "      <td>de</td>\n",
       "      <td>Ciao</td>\n",
       "      <td>ciao.de</td>\n",
       "      <td>2.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Jetzt hat wohl Alcatell gedacht ,sie machen wa...</td>\n",
       "      <td>michaelawr</td>\n",
       "      <td>Alcatel Club Plus Handy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1415131</th>\n",
       "      <td>/cellphones/alcatel-ot-club_1187/</td>\n",
       "      <td>5/1/2000</td>\n",
       "      <td>de</td>\n",
       "      <td>de</td>\n",
       "      <td>Ciao</td>\n",
       "      <td>ciao.de</td>\n",
       "      <td>8.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Ich bin seit 2 Jahren (stolzer) Besitzer eines...</td>\n",
       "      <td>claudia0815</td>\n",
       "      <td>Alcatel Club Plus Handy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1415132</th>\n",
       "      <td>/cellphones/alcatel-ot-club_1187/</td>\n",
       "      <td>4/25/2000</td>\n",
       "      <td>de</td>\n",
       "      <td>de</td>\n",
       "      <td>Ciao</td>\n",
       "      <td>ciao.de</td>\n",
       "      <td>2.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Was sich Alkatel hier wieder ausgedacht hat,sc...</td>\n",
       "      <td>michaelawr</td>\n",
       "      <td>Alcatel Club Plus Handy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1275917 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 phone_url       date lang country  \\\n",
       "0           /cellphones/samsung-galaxy-s8/   5/2/2017   en      us   \n",
       "1           /cellphones/samsung-galaxy-s8/  4/28/2017   en      us   \n",
       "2           /cellphones/samsung-galaxy-s8/   5/4/2017   en      us   \n",
       "3           /cellphones/samsung-galaxy-s8/   5/2/2017   en      us   \n",
       "4           /cellphones/samsung-galaxy-s8/  5/11/2017   en      us   \n",
       "...                                    ...        ...  ...     ...   \n",
       "1415128  /cellphones/alcatel-ot-club_1187/  5/12/2000   de      de   \n",
       "1415129  /cellphones/alcatel-ot-club_1187/  5/11/2000   de      de   \n",
       "1415130  /cellphones/alcatel-ot-club_1187/   5/4/2000   de      de   \n",
       "1415131  /cellphones/alcatel-ot-club_1187/   5/1/2000   de      de   \n",
       "1415132  /cellphones/alcatel-ot-club_1187/  4/25/2000   de      de   \n",
       "\n",
       "                   source               domain  score  score_max  \\\n",
       "0        Verizon Wireless  verizonwireless.com   10.0       10.0   \n",
       "1             Phone Arena       phonearena.com   10.0       10.0   \n",
       "2                  Amazon           amazon.com    6.0       10.0   \n",
       "3                 Samsung          samsung.com    9.0       10.0   \n",
       "4        Verizon Wireless  verizonwireless.com    4.0       10.0   \n",
       "...                   ...                  ...    ...        ...   \n",
       "1415128              Ciao              ciao.de    2.0       10.0   \n",
       "1415129              Ciao              ciao.de   10.0       10.0   \n",
       "1415130              Ciao              ciao.de    2.0       10.0   \n",
       "1415131              Ciao              ciao.de    8.0       10.0   \n",
       "1415132              Ciao              ciao.de    2.0       10.0   \n",
       "\n",
       "                                                   extract        author  \\\n",
       "0        As a diehard Samsung fan who has had every Sam...    CarolAnn35   \n",
       "1        Love the phone. the phone is sleek and smooth ...     james0923   \n",
       "2        Adequate feel. Nice heft. Processor's still sl...      R. Craig   \n",
       "3        Never disappointed. One of the reasons I've be...   Buster2020    \n",
       "4        I've now found that i'm in a group of people t...    S Ate Mine   \n",
       "...                                                    ...           ...   \n",
       "1415128  Weil mein Onkel bei ALcatel arbeitet habe ich ...    david.paul   \n",
       "1415129  Hy Liebe Leserinnen und Leser!! Ich habe seit ...  Christiane14   \n",
       "1415130  Jetzt hat wohl Alcatell gedacht ,sie machen wa...    michaelawr   \n",
       "1415131  Ich bin seit 2 Jahren (stolzer) Besitzer eines...   claudia0815   \n",
       "1415132  Was sich Alkatel hier wieder ausgedacht hat,sc...    michaelawr   \n",
       "\n",
       "                                                   product  \n",
       "0                                        Samsung Galaxy S8  \n",
       "1                                        Samsung Galaxy S8  \n",
       "2        Samsung Galaxy S8 (64GB) G950U 5.8\" 4G LTE Unl...  \n",
       "3                            Samsung Galaxy S8 64GB (AT&T)  \n",
       "4                                        Samsung Galaxy S8  \n",
       "...                                                    ...  \n",
       "1415128                            Alcatel Club Plus Handy  \n",
       "1415129                            Alcatel Club Plus Handy  \n",
       "1415130                            Alcatel Club Plus Handy  \n",
       "1415131                            Alcatel Club Plus Handy  \n",
       "1415132                            Alcatel Club Plus Handy  \n",
       "\n",
       "[1275917 rows x 11 columns]"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "45c7122b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "phone_url    0\n",
       "date         0\n",
       "lang         0\n",
       "country      0\n",
       "source       0\n",
       "domain       0\n",
       "score        0\n",
       "score_max    0\n",
       "extract      0\n",
       "author       0\n",
       "product      0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bc845a42",
   "metadata": {},
   "source": [
    "### E.Check for duplicate values and remove them, if any."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "1c3a0691",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0          False\n",
       "1          False\n",
       "2          False\n",
       "3          False\n",
       "4          False\n",
       "           ...  \n",
       "1415128    False\n",
       "1415129    False\n",
       "1415130    False\n",
       "1415131    False\n",
       "1415132    False\n",
       "Length: 1275917, dtype: bool"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.duplicated() "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "0428d386",
   "metadata": {},
   "outputs": [],
   "source": [
    "combined_review_file = combined_review_file.drop_duplicates()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "id": "2090722a",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>phone_url</th>\n",
       "      <th>date</th>\n",
       "      <th>lang</th>\n",
       "      <th>country</th>\n",
       "      <th>source</th>\n",
       "      <th>domain</th>\n",
       "      <th>score</th>\n",
       "      <th>score_max</th>\n",
       "      <th>extract</th>\n",
       "      <th>author</th>\n",
       "      <th>product</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>510111</th>\n",
       "      <td>/cellphones/lenovo-vibe-k5/</td>\n",
       "      <td>7/25/2016</td>\n",
       "      <td>en</td>\n",
       "      <td>in</td>\n",
       "      <td>Amazon</td>\n",
       "      <td>amazon.in</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Good product in this price...</td>\n",
       "      <td>KHILESH KUMAR VERMA</td>\n",
       "      <td>Lenovo Vibe K5 (Gold, VoLTE update)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104794</th>\n",
       "      <td>/cellphones/samsung-galaxy-s6/</td>\n",
       "      <td>11/10/2016</td>\n",
       "      <td>es</td>\n",
       "      <td>es</td>\n",
       "      <td>Samsung</td>\n",
       "      <td>samsung.com</td>\n",
       "      <td>8.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>En general me gusta mucho mi nuevo S6, el reco...</td>\n",
       "      <td>Evyta</td>\n",
       "      <td>Samsung Galaxy S6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1222473</th>\n",
       "      <td>/cellphones/sony-ericsson-k810i/</td>\n",
       "      <td>1/3/2010</td>\n",
       "      <td>ru</td>\n",
       "      <td>ru</td>\n",
       "      <td>Yandex</td>\n",
       "      <td>market.yandex.ru</td>\n",
       "      <td>8.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Ð½ÐµÑÐ¼Ð¾ÑÑÑ Ð½Ð° Ð½ÐµÐ´Ð¾ÑÑÐ°ÑÐºÐ¸ Ð² ...</td>\n",
       "      <td>VanRaZor</td>\n",
       "      <td>Sony Ericsson K810i</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>452910</th>\n",
       "      <td>/cellphones/sony-xperia-z2/</td>\n",
       "      <td>7/19/2014</td>\n",
       "      <td>ru</td>\n",
       "      <td>ua</td>\n",
       "      <td>Hotline.ua</td>\n",
       "      <td>hotline.ua</td>\n",
       "      <td>6.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>ÐÑÑÑ ÑÐ¶Ðµ ÑÐ°Ð·Ð²ÐµÑÐ½ÑÑÑÐ¹ Ð¾ÑÐ·Ñ...</td>\n",
       "      <td>ruga</td>\n",
       "      <td>Sony Xperia Z2 (Black)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16933</th>\n",
       "      <td>/cellphones/samsung-galaxy-s7-edge/</td>\n",
       "      <td>10/21/2016</td>\n",
       "      <td>de</td>\n",
       "      <td>de</td>\n",
       "      <td>Otto.de</td>\n",
       "      <td>otto.de</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Ein Wahnsinns Handy! Macht richtig schÃ¶ne Bil...</td>\n",
       "      <td>einer Kundin</td>\n",
       "      <td>Samsung Galaxy S7 edge Smartphone, 13,9 cm (5,...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   phone_url        date lang country  \\\n",
       "510111           /cellphones/lenovo-vibe-k5/   7/25/2016   en      in   \n",
       "104794        /cellphones/samsung-galaxy-s6/  11/10/2016   es      es   \n",
       "1222473     /cellphones/sony-ericsson-k810i/    1/3/2010   ru      ru   \n",
       "452910           /cellphones/sony-xperia-z2/   7/19/2014   ru      ua   \n",
       "16933    /cellphones/samsung-galaxy-s7-edge/  10/21/2016   de      de   \n",
       "\n",
       "             source            domain  score  score_max  \\\n",
       "510111       Amazon         amazon.in   10.0       10.0   \n",
       "104794      Samsung       samsung.com    8.0       10.0   \n",
       "1222473      Yandex  market.yandex.ru    8.0       10.0   \n",
       "452910   Hotline.ua        hotline.ua    6.0       10.0   \n",
       "16933       Otto.de           otto.de   10.0       10.0   \n",
       "\n",
       "                                                   extract  \\\n",
       "510111                       Good product in this price...   \n",
       "104794   En general me gusta mucho mi nuevo S6, el reco...   \n",
       "1222473  Ð½ÐµÑÐ¼Ð¾ÑÑÑ Ð½Ð° Ð½ÐµÐ´Ð¾ÑÑÐ°ÑÐºÐ¸ Ð² ...   \n",
       "452910   ÐÑÑÑ ÑÐ¶Ðµ ÑÐ°Ð·Ð²ÐµÑÐ½ÑÑÑÐ¹ Ð¾ÑÐ·Ñ...   \n",
       "16933    Ein Wahnsinns Handy! Macht richtig schÃ¶ne Bil...   \n",
       "\n",
       "                      author  \\\n",
       "510111   KHILESH KUMAR VERMA   \n",
       "104794                 Evyta   \n",
       "1222473             VanRaZor   \n",
       "452910                  ruga   \n",
       "16933           einer Kundin   \n",
       "\n",
       "                                                   product  \n",
       "510111                 Lenovo Vibe K5 (Gold, VoLTE update)  \n",
       "104794                                   Samsung Galaxy S6  \n",
       "1222473                                Sony Ericsson K810i  \n",
       "452910                              Sony Xperia Z2 (Black)  \n",
       "16933    Samsung Galaxy S7 edge Smartphone, 13,9 cm (5,...  "
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a48e646",
   "metadata": {},
   "source": [
    "### F.Keep only 1 Million data samples. Use random state=612"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "72505aa7",
   "metadata": {},
   "outputs": [],
   "source": [
    "combined_review_file = combined_review_file.sample(n=1000000, random_state=612)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "9aae280b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1000000, 11)"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a71681d",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "b107200d",
   "metadata": {},
   "source": [
    "### G.Drop irrelevant features. Keep features like Author, Product, and Score. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc9739c0",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "41ccb9c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "combined_review_file = combined_review_file.drop(columns=['phone_url', 'date', 'lang', 'country', 'domain', 'score_max', 'extract'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "id": "0c082b9b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1000000, 4)"
      ]
     },
     "execution_count": 80,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "id": "9db3fe7f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>score</th>\n",
       "      <th>author</th>\n",
       "      <th>product</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>510111</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>10.0</td>\n",
       "      <td>KHILESH KUMAR VERMA</td>\n",
       "      <td>Lenovo Vibe K5 (Gold, VoLTE update)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104794</th>\n",
       "      <td>Samsung</td>\n",
       "      <td>8.0</td>\n",
       "      <td>Evyta</td>\n",
       "      <td>Samsung Galaxy S6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1222473</th>\n",
       "      <td>Yandex</td>\n",
       "      <td>8.0</td>\n",
       "      <td>VanRaZor</td>\n",
       "      <td>Sony Ericsson K810i</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>452910</th>\n",
       "      <td>Hotline.ua</td>\n",
       "      <td>6.0</td>\n",
       "      <td>ruga</td>\n",
       "      <td>Sony Xperia Z2 (Black)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16933</th>\n",
       "      <td>Otto.de</td>\n",
       "      <td>10.0</td>\n",
       "      <td>einer Kundin</td>\n",
       "      <td>Samsung Galaxy S7 edge Smartphone, 13,9 cm (5,...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             source  score               author  \\\n",
       "510111       Amazon   10.0  KHILESH KUMAR VERMA   \n",
       "104794      Samsung    8.0                Evyta   \n",
       "1222473      Yandex    8.0             VanRaZor   \n",
       "452910   Hotline.ua    6.0                 ruga   \n",
       "16933       Otto.de   10.0         einer Kundin   \n",
       "\n",
       "                                                   product  \n",
       "510111                 Lenovo Vibe K5 (Gold, VoLTE update)  \n",
       "104794                                   Samsung Galaxy S6  \n",
       "1222473                                Sony Ericsson K810i  \n",
       "452910                              Sony Xperia Z2 (Black)  \n",
       "16933    Samsung Galaxy S7 edge Smartphone, 13,9 cm (5,...  "
      ]
     },
     "execution_count": 140,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "20e3d483",
   "metadata": {},
   "source": [
    "### 2.A.Identify the most rated products"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "4bb1040c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                                            product  Rating\n",
      "20584              Lenovo Vibe K4 Note (White,16GB)    4109\n",
      "20583             Lenovo Vibe K4 Note (Black, 16GB)    3451\n",
      "29905                   OnePlus 3 (Graphite, 64 GB)    3212\n",
      "29906                  OnePlus 3 (Soft Gold, 64 GB)    2798\n",
      "14865                   Huawei P8lite zwart / 16 GB    2121\n",
      "20587           Lenovo Vibe K5 (Gold, VoLTE update)    2011\n",
      "38296               Samsung Galaxy S6 zwart / 32 GB    1837\n",
      "20589           Lenovo Vibe K5 (Grey, VoLTE update)    1680\n",
      "20552  Lenovo Used Lenovo Zuk Z1 (Space Grey, 64GB)    1529\n",
      "35352                       Samsung Galaxy J3 (8GB)    1449\n"
     ]
    }
   ],
   "source": [
    "# Group the data by song title and count the number of times each song appears\n",
    "product_ratings = combined_review_file.groupby('product').size().reset_index(name='Rating')\n",
    "\n",
    "# Sort the dataframe by the count in descending order\n",
    "product_ratings = product_ratings.sort_values('Rating', ascending=False)\n",
    "\n",
    "# Print the top 10 most popular songs\n",
    "print(product_ratings.head(10))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "id": "ef1068c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "# These are the top 10 most rated products"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "id": "a65f2ee1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>score</th>\n",
       "      <th>author</th>\n",
       "      <th>product</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>425045</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>430609</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>427815</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>430028</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>425588</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>8.0</td>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>431098</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>6.0</td>\n",
       "      <td>shivam</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>428960</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>6.0</td>\n",
       "      <td>surendran</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>424698</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>424599</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>10.0</td>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>431073</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>8.0</td>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4109 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        source  score           author                           product\n",
       "425045  Amazon   10.0  Amazon Customer  Lenovo Vibe K4 Note (White,16GB)\n",
       "430609  Amazon   10.0  Amazon Customer  Lenovo Vibe K4 Note (White,16GB)\n",
       "427815  Amazon    2.0  Amazon Customer  Lenovo Vibe K4 Note (White,16GB)\n",
       "430028  Amazon    6.0  Amazon Customer  Lenovo Vibe K4 Note (White,16GB)\n",
       "425588  Amazon    8.0  Amazon Customer  Lenovo Vibe K4 Note (White,16GB)\n",
       "...        ...    ...              ...                               ...\n",
       "431098  Amazon    6.0           shivam  Lenovo Vibe K4 Note (White,16GB)\n",
       "428960  Amazon    6.0        surendran  Lenovo Vibe K4 Note (White,16GB)\n",
       "424698  Amazon    2.0  Amazon Customer  Lenovo Vibe K4 Note (White,16GB)\n",
       "424599  Amazon   10.0  Amazon Customer  Lenovo Vibe K4 Note (White,16GB)\n",
       "431073  Amazon    8.0  Amazon Customer  Lenovo Vibe K4 Note (White,16GB)\n",
       "\n",
       "[4109 rows x 4 columns]"
      ]
     },
     "execution_count": 102,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file[combined_review_file['product'] == 'Lenovo Vibe K4 Note (White,16GB)']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e61db813",
   "metadata": {},
   "source": [
    "### 2.B.Identify the users with most number of reviews"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "id": "3944e950",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                 author  Review Counts\n",
      "23791   Amazon Customer          60408\n",
      "76669    Cliente Amazon          15051\n",
      "454524            e-bit           6651\n",
      "76646   Client d'Amazon           6087\n",
      "24153      Amazon Kunde           3683\n",
      "32700         Anonymous           2096\n",
      "455976     einer Kundin           2065\n",
      "455974     einem Kunden           1452\n",
      "587883          unknown           1350\n",
      "32701        Anonymous            1161\n"
     ]
    }
   ],
   "source": [
    "# Group the data by song title and count the number of times each song appears\n",
    "user_review_counts = combined_review_file.groupby('author').size().reset_index(name='Review Counts')\n",
    "\n",
    "# Sort the dataframe by the count in descending order\n",
    "user_review_counts = user_review_counts.sort_values('Review Counts', ascending=False)\n",
    "\n",
    "# Print the top 10 most popular songs\n",
    "print(user_review_counts.head(10))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f8ed3d2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "9bd7da85",
   "metadata": {},
   "source": [
    "### 2.C.Select the data with products having more than 50 ratings and users who have given more than 50 ratings. Report the shape of the final dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "57ed0bcf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>product</th>\n",
       "      <th>Rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>20584</th>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "      <td>4109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20583</th>\n",
       "      <td>Lenovo Vibe K4 Note (Black, 16GB)</td>\n",
       "      <td>3451</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29905</th>\n",
       "      <td>OnePlus 3 (Graphite, 64 GB)</td>\n",
       "      <td>3212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29906</th>\n",
       "      <td>OnePlus 3 (Soft Gold, 64 GB)</td>\n",
       "      <td>2798</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14865</th>\n",
       "      <td>Huawei P8lite zwart / 16 GB</td>\n",
       "      <td>2121</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26664</th>\n",
       "      <td>Nokia 6303I Classic Sim Free Mobile Phone - Bl...</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7879</th>\n",
       "      <td>Buyus Coque Gel transparent INVISIBLE Samsung ...</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18771</th>\n",
       "      <td>LG Optimus L5 - Smartphone libre Android (pant...</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23057</th>\n",
       "      <td>Motorola E White (Boost Mobile)</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30676</th>\n",
       "      <td>Prada phone by LG 3.0 Smartphone (10,9 cm (4,3...</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4473 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                 product  Rating\n",
       "20584                   Lenovo Vibe K4 Note (White,16GB)    4109\n",
       "20583                  Lenovo Vibe K4 Note (Black, 16GB)    3451\n",
       "29905                        OnePlus 3 (Graphite, 64 GB)    3212\n",
       "29906                       OnePlus 3 (Soft Gold, 64 GB)    2798\n",
       "14865                        Huawei P8lite zwart / 16 GB    2121\n",
       "...                                                  ...     ...\n",
       "26664  Nokia 6303I Classic Sim Free Mobile Phone - Bl...      51\n",
       "7879   Buyus Coque Gel transparent INVISIBLE Samsung ...      51\n",
       "18771  LG Optimus L5 - Smartphone libre Android (pant...      51\n",
       "23057                    Motorola E White (Boost Mobile)      51\n",
       "30676  Prada phone by LG 3.0 Smartphone (10,9 cm (4,3...      51\n",
       "\n",
       "[4473 rows x 2 columns]"
      ]
     },
     "execution_count": 134,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "product_ratings[product_ratings['Rating'] > 50] "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "id": "a221eecd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>author</th>\n",
       "      <th>Review Counts</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>23791</th>\n",
       "      <td>Amazon Customer</td>\n",
       "      <td>60408</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76669</th>\n",
       "      <td>Cliente Amazon</td>\n",
       "      <td>15051</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>454524</th>\n",
       "      <td>e-bit</td>\n",
       "      <td>6651</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76646</th>\n",
       "      <td>Client d'Amazon</td>\n",
       "      <td>6087</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24153</th>\n",
       "      <td>Amazon Kunde</td>\n",
       "      <td>3683</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199677</th>\n",
       "      <td>Kat</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197204</th>\n",
       "      <td>Kai</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>324669</th>\n",
       "      <td>Roger</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>193896</th>\n",
       "      <td>JÃ¶rg</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>184148</th>\n",
       "      <td>Johan</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>630 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 author  Review Counts\n",
       "23791   Amazon Customer          60408\n",
       "76669    Cliente Amazon          15051\n",
       "454524            e-bit           6651\n",
       "76646   Client d'Amazon           6087\n",
       "24153      Amazon Kunde           3683\n",
       "...                 ...            ...\n",
       "199677              Kat             51\n",
       "197204              Kai             51\n",
       "324669            Roger             51\n",
       "193896            JÃ¶rg             51\n",
       "184148            Johan             51\n",
       "\n",
       "[630 rows x 2 columns]"
      ]
     },
     "execution_count": 131,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_review_counts[user_review_counts['Review Counts'] > 50]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "829e73dd",
   "metadata": {},
   "source": [
    "### 3.Build a popularity based model and recommend top 5 mobile phones"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "1fc2e5c7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "          source  score          author  \\\n",
      "796238   Samsung   10.0          Mancho   \n",
      "789593    Yandex   10.0  cool.natalka75   \n",
      "419870    Amazon    6.0         rafa297   \n",
      "1193624     Ciao    8.0          easyCE   \n",
      "1174617   Amazon    8.0        Linda H.   \n",
      "\n",
      "                                                   product  \n",
      "796238                                Samsung Galaxy S III  \n",
      "789593                                     Nokia Lumia 920  \n",
      "419870   BQ Aquaris E4.5 - Smartphone libre Android (pa...  \n",
      "1193624                                          Nokia E66  \n",
      "1174617  Motorola Entice W766 Cell Phone Verizon or Pag...  \n"
     ]
    }
   ],
   "source": [
    "train_data, test_data = train_test_split(combined_review_file, test_size = 0.20, random_state=0)\n",
    "print(train_data.head(5))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "id": "d12f9d6b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>product</th>\n",
       "      <th>score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>'Sony Xperia X (F5122) â White â Dual Sim ...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>'Sony Xperia X (F5122) â rosa â Dual Sim (...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>(7.62 cm (3 )Afficheur/Ã©cran, 2 MPixCamÃ©ra;b...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>(CUBOT) GT88 5.5\" qHD 1.3GHz MTK6572 2-Core An...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>(DG300 Versione Aggiornata)5'' DOOGEE VOYAGER2...</td>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                             product  score\n",
       "0  'Sony Xperia X (F5122) â White â Dual Sim ...      1\n",
       "1  'Sony Xperia X (F5122) â rosa â Dual Sim (...      1\n",
       "2  (7.62 cm (3 )Afficheur/Ã©cran, 2 MPixCamÃ©ra;b...      1\n",
       "3  (CUBOT) GT88 5.5\" qHD 1.3GHz MTK6572 2-Core An...      1\n",
       "4  (DG300 Versione Aggiornata)5'' DOOGEE VOYAGER2...     30"
      ]
     },
     "execution_count": 138,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Count of user_id for each unique song as recommendation score \n",
    "train_data_grouped = train_data.groupby('product').agg({'author': 'count'}).reset_index()\n",
    "train_data_grouped.rename(columns = {'author': 'score'},inplace=True)\n",
    "train_data_grouped.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "id": "7550c8ab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>product</th>\n",
       "      <th>score</th>\n",
       "      <th>Rank</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>19571</th>\n",
       "      <td>Lenovo Vibe K4 Note (White,16GB)</td>\n",
       "      <td>3282</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19570</th>\n",
       "      <td>Lenovo Vibe K4 Note (Black, 16GB)</td>\n",
       "      <td>2807</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28449</th>\n",
       "      <td>OnePlus 3 (Graphite, 64 GB)</td>\n",
       "      <td>2571</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28450</th>\n",
       "      <td>OnePlus 3 (Soft Gold, 64 GB)</td>\n",
       "      <td>2237</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14102</th>\n",
       "      <td>Huawei P8lite zwart / 16 GB</td>\n",
       "      <td>1683</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 product  score  Rank\n",
       "19571   Lenovo Vibe K4 Note (White,16GB)   3282   1.0\n",
       "19570  Lenovo Vibe K4 Note (Black, 16GB)   2807   2.0\n",
       "28449        OnePlus 3 (Graphite, 64 GB)   2571   3.0\n",
       "28450       OnePlus 3 (Soft Gold, 64 GB)   2237   4.0\n",
       "14102        Huawei P8lite zwart / 16 GB   1683   5.0"
      ]
     },
     "execution_count": 139,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Sort the songs on recommendation score \n",
    "train_data_sort = train_data_grouped.sort_values(['score', 'product'], ascending = [0,1]) \n",
    "      \n",
    "#Generate a recommendation rank based upon score \n",
    "train_data_sort['Rank'] = train_data_sort['score'].rank(ascending=0, method='first') \n",
    "          \n",
    "#Get the top 5 recommendations \n",
    "popularity_recommendations = train_data_sort.head(5) \n",
    "popularity_recommendations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2fb7f75a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Above are the top 5 phone recommendations."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a4e14f50",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "b94eed76",
   "metadata": {},
   "source": [
    "### 4. Build a collaborative filtering model using SVD. You can use SVD from surprise or build it from scratch. Build a collaborative filtering model using kNNWithMeans from surprise. You can try both user-based and item-based model."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69e0e17c",
   "metadata": {},
   "source": [
    "### 5.Evaluate the collaborative model. Print RMSE value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "id": "95e29b49",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting surprise\n",
      "  Downloading surprise-0.1-py2.py3-none-any.whl (1.8 kB)\n",
      "Collecting scikit-surprise\n",
      "  Downloading scikit-surprise-1.1.3.tar.gz (771 kB)\n",
      "\u001b[K     |████████████████████████████████| 771 kB 1.1 MB/s eta 0:00:01\n",
      "\u001b[?25hRequirement already satisfied: joblib>=1.0.0 in /Users/manishsingh/opt/anaconda3/lib/python3.9/site-packages (from scikit-surprise->surprise) (1.1.0)\n",
      "Requirement already satisfied: numpy>=1.17.3 in /Users/manishsingh/opt/anaconda3/lib/python3.9/site-packages (from scikit-surprise->surprise) (1.21.5)\n",
      "Requirement already satisfied: scipy>=1.3.2 in /Users/manishsingh/opt/anaconda3/lib/python3.9/site-packages (from scikit-surprise->surprise) (1.7.3)\n",
      "Building wheels for collected packages: scikit-surprise\n",
      "  Building wheel for scikit-surprise (setup.py) ... \u001b[?25ldone\n",
      "\u001b[?25h  Created wheel for scikit-surprise: filename=scikit_surprise-1.1.3-cp39-cp39-macosx_10_9_x86_64.whl size=1146371 sha256=8738cc297020b4318b55a25de2a059987c10c9c0aa5d033dc63918868a5441d0\n",
      "  Stored in directory: /Users/manishsingh/Library/Caches/pip/wheels/c6/3a/46/9b17b3512bdf283c6cb84f59929cdd5199d4e754d596d22784\n",
      "Successfully built scikit-surprise\n",
      "Installing collected packages: scikit-surprise, surprise\n",
      "Successfully installed scikit-surprise-1.1.3 surprise-0.1\n"
     ]
    }
   ],
   "source": [
    "!pip install surprise"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "id": "659c034e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>score</th>\n",
       "      <th>author</th>\n",
       "      <th>product</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>510111</th>\n",
       "      <td>Amazon</td>\n",
       "      <td>10.0</td>\n",
       "      <td>KHILESH KUMAR VERMA</td>\n",
       "      <td>Lenovo Vibe K5 (Gold, VoLTE update)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104794</th>\n",
       "      <td>Samsung</td>\n",
       "      <td>8.0</td>\n",
       "      <td>Evyta</td>\n",
       "      <td>Samsung Galaxy S6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1222473</th>\n",
       "      <td>Yandex</td>\n",
       "      <td>8.0</td>\n",
       "      <td>VanRaZor</td>\n",
       "      <td>Sony Ericsson K810i</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>452910</th>\n",
       "      <td>Hotline.ua</td>\n",
       "      <td>6.0</td>\n",
       "      <td>ruga</td>\n",
       "      <td>Sony Xperia Z2 (Black)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16933</th>\n",
       "      <td>Otto.de</td>\n",
       "      <td>10.0</td>\n",
       "      <td>einer Kundin</td>\n",
       "      <td>Samsung Galaxy S7 edge Smartphone, 13,9 cm (5,...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             source  score               author  \\\n",
       "510111       Amazon   10.0  KHILESH KUMAR VERMA   \n",
       "104794      Samsung    8.0                Evyta   \n",
       "1222473      Yandex    8.0             VanRaZor   \n",
       "452910   Hotline.ua    6.0                 ruga   \n",
       "16933       Otto.de   10.0         einer Kundin   \n",
       "\n",
       "                                                   product  \n",
       "510111                 Lenovo Vibe K5 (Gold, VoLTE update)  \n",
       "104794                                   Samsung Galaxy S6  \n",
       "1222473                                Sony Ericsson K810i  \n",
       "452910                              Sony Xperia Z2 (Black)  \n",
       "16933    Samsung Galaxy S7 edge Smartphone, 13,9 cm (5,...  "
      ]
     },
     "execution_count": 144,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "combined_review_file.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "9d92bb0c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from surprise import Dataset,Reader\n",
    "from surprise.model_selection import cross_validate\n",
    "from surprise import NormalPredictor\n",
    "\n",
    "\n",
    "reader = Reader(rating_scale=(1, 10))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "id": "12820540",
   "metadata": {},
   "outputs": [],
   "source": [
    "data = Dataset.load_from_df(combined_review_file[['author', 'product', 'score']], reader)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "id": "d831487c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Split data to train and test\n",
    "from surprise.model_selection import train_test_split\n",
    "trainset, testset = train_test_split(data, test_size=.25,random_state=123)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "eb616917",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<generator object Trainset.all_ratings at 0x7fcdb51bff90>"
      ]
     },
     "execution_count": 148,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "trainset.all_ratings()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "id": "df619607",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ukfemale86\n"
     ]
    }
   ],
   "source": [
    "print(trainset.to_raw_uid(5))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "id": "985c1af2",
   "metadata": {},
   "outputs": [],
   "source": [
    "from surprise import SVD, KNNWithMeans\n",
    "from surprise import accuracy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "de86e35c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<surprise.prediction_algorithms.matrix_factorization.SVD at 0x7fcda66d3550>"
      ]
     },
     "execution_count": 152,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "svd_model = SVD(n_factors=5,biased=False)\n",
    "svd_model.fit(trainset)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "id": "ab792ab8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "('jose francisco fernandez alvarez', 'Huawei P10 Lite', 10.0)"
      ]
     },
     "execution_count": 153,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "testset[5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "309942bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "test_pred = svd_model.test(testset)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "id": "dcb40e51",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "RMSE: 3.1359\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "3.1359125825872916"
      ]
     },
     "execution_count": 155,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# compute RMSE\n",
    "accuracy.rmse(test_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "id": "8229a685",
   "metadata": {},
   "outputs": [],
   "source": [
    "# KNNWithMeans"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "cf3fba7b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Computing the msd similarity matrix...\n",
      "Done computing similarity matrix.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<surprise.prediction_algorithms.knns.KNNWithMeans at 0x7fcdaff138e0>"
      ]
     },
     "execution_count": 156,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from surprise import KNNWithMeans\n",
    "from surprise import accuracy\n",
    "\n",
    "algo_i = KNNWithMeans(k=10, sim_options={ 'user_based': False})\n",
    "\n",
    "algo_i.fit(trainset)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "fad1b75b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "RMSE: 2.6492\n",
      "2.6492295662548546\n"
     ]
    }
   ],
   "source": [
    "test_pred=algo_i.test(testset)\n",
    "print(accuracy.rmse(test_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "e5e81752",
   "metadata": {},
   "outputs": [],
   "source": [
    "# KNNWithMeans improved result"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3a5d9d71",
   "metadata": {},
   "source": [
    "### 6.Predict score (average rating) for test users"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "id": "9f3001a3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "user: test       item: test       r_ui = 0.00   est = 8.01   {'was_impossible': True, 'reason': 'User and/or item is unknown.'}\n"
     ]
    }
   ],
   "source": [
    "uid = \"test\"  \n",
    "iid = \"test\"  \n",
    "\n",
    "# get a prediction for specific users and items.\n",
    "pred = algo_i.predict(uid, iid, r_ui=0.0, verbose=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "id": "686d2bbf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iid</th>\n",
       "      <th>r_ui</th>\n",
       "      <th>est</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>20046</th>\n",
       "      <td>Motorola Starling EX112 Titanium Smartphone (5...</td>\n",
       "      <td>10.0</td>\n",
       "      <td>7.714286</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                     iid  r_ui       est\n",
       "20046  Motorola Starling EX112 Titanium Smartphone (5...  10.0  7.714286"
      ]
     },
     "execution_count": 172,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pred = pd.DataFrame(test_pred)\n",
    "pred[pred['uid'] == 'test'][['iid', 'r_ui','est']].sort_values(by = 'r_ui',ascending = False).head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8386ebf2",
   "metadata": {},
   "source": [
    "### 7.Report your findings and inferences. "
   ]
  },
  {
   "cell_type": "raw",
   "id": "4f0fa6c2",
   "metadata": {},
   "source": [
    "Model predicts average rating wherever estimation is not possible.\n",
    "\n",
    "Model-based Collaborative Filtering is a personalised recommender system, the recommendations are based on the past behavior of the user and it is not dependent on any additional information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae3d6675",
   "metadata": {},
   "source": [
    "### 8.Try and recommend top 5 products for test users"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 175,
   "id": "ccdb4082",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iid</th>\n",
       "      <th>r_ui</th>\n",
       "      <th>est</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>20046</th>\n",
       "      <td>Motorola Starling EX112 Titanium Smartphone (5...</td>\n",
       "      <td>10.0</td>\n",
       "      <td>7.714286</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                     iid  r_ui       est\n",
       "20046  Motorola Starling EX112 Titanium Smartphone (5...  10.0  7.714286"
      ]
     },
     "execution_count": 175,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "uid = \"test\"\n",
    "\n",
    "pred = pd.DataFrame(test_pred)\n",
    "pred[pred['uid'] == uid][['iid', 'r_ui','est']].sort_values(by = 'r_ui',ascending = False).head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "12dfc66a",
   "metadata": {},
   "source": [
    "### 9.Try other techniques (Example: cross validation) to get better results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f4407fcc",
   "metadata": {},
   "outputs": [],
   "source": [
    "from surprise.model_selection import cross_validate\n",
    "\n",
    "cross_validate_KNN = cross_validate(algo_KNN, rating_df, measures=['RMSE', 'MAE'], cv=5, verbose=True)\n",
    "\n",
    "cross_validate_SVD = cross_validate(algo_SVD, rating_df, measures=['RMSE', 'MAE'], cv=5, verbose=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c27fe485",
   "metadata": {},
   "source": [
    "## 10. In what business scenario you should use popularity based Recommendation Systems ?\n",
    "\n",
    "Popularity-based recommendation systems rely on the assumption that items that are popular among a large number of users are likely to be of interest to new users as well. These systems are relatively straightforward to implement and can be useful in certain situations, such as when there is a diverse and large user base and a broad range of items available for recommendation.\n",
    "\n",
    "Here are some examples of business scenarios where popularity-based recommendation systems might be used:\n",
    "\n",
    "E-commerce websites: Popularity-based recommendation systems can suggest popular products to new users on an e-commerce website. For instance, a website may suggest the best-selling electronic devices or the most popular clothing items.\n",
    "\n",
    "Streaming platforms: Popularity-based recommendation systems can recommend popular movies, TV shows, or music on streaming platforms. These recommendations can be based on the overall popularity of the content or on the popularity of the content within specific genres or categories.\n",
    "\n",
    "Social media platforms: Popularity-based recommendation systems can suggest popular posts, pages, or profiles on social media platforms. For example, a social media platform might recommend the most popular posts or pages based on the number of likes, comments, or shares they have received.\n",
    "\n",
    "News websites: Popularity-based recommendation systems can recommend the most popular articles or news stories on a news website. These recommendations can be based on the overall popularity of the articles or on the popularity of the articles within specific categories or topics."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d65086d1",
   "metadata": {},
   "source": [
    "### 11.In what business scenario you should use CF based Recommendation Systems ?\n",
    "\n",
    "Collaborative filtering recommendation systems operate on the principle that users with similar tastes or preferences are likely to have a shared interest in particular items. These systems rely on the feedback or ratings provided by users to suggest recommendations to other users. There are two main types of collaborative filtering:\n",
    "\n",
    "User-based collaborative filtering: This approach suggests items to a user based on the ratings or preferences of similar users. For instance, if two users have rated several movies similarly, the system might suggest movies to one of them based on the ratings of the other.\n",
    "\n",
    "Item-based collaborative filtering: This approach recommends items to a user based on the ratings or preferences of other users who have rated similar items. For example, if a user has rated action movies highly, the system might recommend other action movies based on the ratings of other users who have also rated those movies positively.\n",
    "\n",
    "Collaborative filtering-based recommendation systems can be used in various business scenarios, such as:\n",
    "\n",
    "E-commerce platforms: Collaborative filtering can suggest products to users on an e-commerce website based on the preferences and ratings of similar users.\n",
    "\n",
    "Streaming services: Collaborative filtering can recommend movies, TV shows, or music to users on a streaming platform based on the ratings and preferences of similar users.\n",
    "\n",
    "Social media platforms: Collaborative filtering can suggest posts, pages, or profiles to users on a social media platform based on the ratings and preferences of similar users.\n",
    "\n",
    "Online review platforms: Collaborative filtering can recommend products or services to users on an online review website based on the ratings and preferences of similar users.\n",
    "\n",
    "News websites: Collaborative filtering can suggest articles or news stories to users on a news website based on the ratings and preferences of similar users."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b1cef874",
   "metadata": {},
   "source": [
    "### 12. What other possible methods can you think of which can further improve the recommendation for different users?\n",
    "\n",
    "There are various methods that can be employed to enhance recommendation systems for different users. Some of these methods include:\n",
    "\n",
    "Context-aware recommendation: This approach considers the context in which a recommendation is made, such as the user's location, time of day, or current activity, to provide more relevant recommendations. For instance, a recommendation system might suggest different movies to a user based on whether they are at home or at the cinema.\n",
    "\n",
    "Hybrid recommendation: This approach combines multiple recommendation techniques to create a more precise and personalized recommendation. For example, a recommendation system may use both collaborative filtering and content-based filtering to suggest items to a user.\n",
    "\n",
    "Personalization: Personalization involves collecting data about a user's preferences, interests, and behavior, and using this information to customize recommendations to the individual user. This can be accomplished through methods such as collaborative filtering, content-based filtering, or context-aware recommendation.\n",
    "\n",
    "Explanation of recommendations: This approach entails giving users an explanation for why a particular item was recommended to them. This can assist in developing trust in the recommendation system and enhancing the user experience.\n",
    "\n",
    "Cold start problem: This refers to the difficulty of providing recommendations to new users or for items with little or no ratings or feedback. One solution to this issue is to use knowledge-based recommendation, which involves using expert knowledge or external information about an item to make recommendations. Another solution is to use hybrid recommendation systems, which can use both collaborative filtering and content-based filtering to make recommendations."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "536e35b5",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
